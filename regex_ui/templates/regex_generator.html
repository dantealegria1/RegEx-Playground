{% extends 'base.html' %}

{% block title %}Regex String Generator{% endblock %}

{% block extra_js %}
    <script>
      async function reverseString(event) {
        event.preventDefault();
        const inputString = document.getElementById("stringInput").value;

        // Retrieve CSRF token from the cookie
        const getCookie = (name) => {
            let cookieValue = null;
            if (document.cookie && document.cookie !== "") {
                const cookies = document.cookie.split(";");
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.startsWith(name + "=")) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        };
        const csrftoken = getCookie("csrftoken");

        // Send the POST request
        const response = await fetch('/logic/regex/', {
            method: "POST",
            headers: {
                "Content-Type": "application/x-www-form-urlencoded",
                "X-CSRFToken": csrftoken, // Include the CSRF token in the header
            },
            body: new URLSearchParams({ string: inputString }),
        });
        const data = await response.json();
        
        if (data.pattern) {
            // Format and display the patterns in a list
            const resultDiv = document.getElementById("result");
            resultDiv.innerHTML = "<h3>Generated Patterns:</h3><ul>" + data.pattern.map(pattern => `<li>${pattern}</li>`).join('') + "</ul>";
        } else {
            document.getElementById("result").innerText = `Error: ${data.error}`;
        }
      }
    </script>
{% endblock %}

{% block content %}
    <h1>Generate Regular Expression patterns</h1>
    <div style="display: flex; gap: 2rem;">
        <!-- Form Section -->
        <form onsubmit="reverseString(event)" style="flex: 1;">
            <label for="stringInput">Enter a string:</label>
            <input type="text" id="stringInput" name="string" required>
            <button type="submit">Generate patterns</button> 
        </form>

        <!-- Result Section -->
        <div style="flex: 1;">
            <label>Results:</label>
            <div id="result"></div>
        </div>
    </div>
{% endblock %}

